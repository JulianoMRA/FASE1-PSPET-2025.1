<!DOCTYPE html>
<html>
<head>
    <title>Upload do Gabarito</title>
</head>
<body>
    <h1>Upload do Gabarito</h1>
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <label for="imagem">Escolha a imagem do gabarito:</label>
        <br>
        <input type="file" name="imagem" id="imagem" accept="image/*" required>
        <br>
        <br>
        <label for="prova">Selecione a prova para comparar:</label>
        <br>
        <select name="prova_id" required>
            {% for prova in provas %}
                <option value="{{ prova.id }}">{{ prova.id_prova }} - {{ prova.ano }} - {{ prova.nivel }} - {{ prova.fase }}</option>
            {% endfor %}
        </select>
        <br><br>
        <label for="participante">Selecione o participante:</label>
        <br>
        <select name="participante_id" required>
            {% for participante in participantes %}
                <option value="{{ participante.id }}">{{participante.id}} - {{ participante.nome }} - {{ participante.escola.nome }}</option>
            {% endfor %}
        </select>
        <br><br>
        <label for="pesos">Pesos especiais (ex: 1:2,2:2,3:2):</label>
        <br>
        <input type="text" name="pesos" id="pesos" placeholder="Ex: 1:2,2:2,3:2">
        <br>
        <br>
        <small>
            Informe os pesos das questões no formato <strong>número_da_questão:peso</strong>, separados por vírgula.<br>
            Exemplo: <strong>1:2,2:2,3:2</strong> atribui peso 2 para as questões 1, 2 e 3.<br>
            Questões não informadas terão peso 1 automaticamente.<br>
            O cálculo da nota considera os pesos e normaliza para uma escala de 0 a 10.
        </small>
        <br><br>
        <button type="submit">Subir Gabarito</button>
    </form>

    <hr>

    <h2>Resultado do Gabarito:</h2>

    {% if gabarito_lido %}
        <p><strong>Gabarito Lido:</strong> {{ gabarito_lido }}</p>
        <p><strong>Nota:</strong> {{ nota }}/10</p>
    {% endif %}

    {% if prova_gabarito %}
        <p><strong>Gabarito da Prova Selecionada:</strong> {{ prova_gabarito }}</p>
    {% endif %}

    <a href="{% url 'index' %}">Início</a>
</body>
</html>
